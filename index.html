<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Cotizaciones - SISDOKE</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/print.css" media="print">
</head>
<body class="dark-theme">
    <div class="container">
        <header>
            <div class="logo"></div>
        </header>

        <main class="main-layout">
            <section id="input-column">
                
                <div class="card">
                    <h2>1. Buscar Material</h2>
                    <input type="text" id="search-input" placeholder="Buscar por c√≥digo, marca..." class="large-input" autocomplete="off">
                    <div id="search-results" class="search-results-dropdown"></div>
                </div>

                <div class="card" id="item-form" style="display: none;">
                    <h2>2. Definir Trabajo</h2>
                    <div id="editing-indicator" class="editing-indicator" style="display: none;">
                        <span>üìù Modo: Agregar m√°s del mismo producto</span>
                    </div>
                    <p id="selected-material-info" class="material-info"></p>
                    
                    <fieldset class="radio-group">
                        <legend>Base de Precio</legend>
                        <label><input type="radio" name="price-base" value="proveedor" id="rb-proveedor"> Proveedor</label>
                        <label><input type="radio" name="price-base" value="cliente" id="rb-cliente" checked> Cliente (Venta por Metro)</label>
                    </fieldset>

                    <input type="text" id="description-input" placeholder="Descripci√≥n (ej. Puerta conductor)" class="large-input" autocomplete="off">
                    <div class="input-group">
                        <input type="number" id="height-input" placeholder="Alto (cm)" class="large-input numeric-input" autocomplete="off">
                        <input type="number" id="width-input" placeholder="Ancho (cm)" class="large-input numeric-input" autocomplete="off">
                    </div>
                    <div class="area-cost-display">
                        <p class="area-display">√Årea: <span id="area-display">0.00</span> m¬≤</p>
                        <p class="cost-display">Costo: <span id="cost-display">S/ 0.00</span></p>
                    </div>
                </div>

                <!-- Nuevo Card: Par√°metros de Venta (Opcional) -->
                <div class="card" id="venta-params-card" style="display: none;">
                    <div class="venta-params-header">
                        <h2>4. Par√°metros de Venta (Opcional)</h2>
                        <button class="collapse-toggle" id="collapse-venta-params">‚ñº</button>
                    </div>
                    <div class="venta-params-content" id="venta-params-content">
                        <div class="setting-item">
                            <label><input type="checkbox" id="vp-waste-active"> Aplicar Desperdicio (%):</label>
                            <input type="number" id="vp-waste-pct-input" placeholder="%" min="0" max="100" class="numeric-input small-input" autocomplete="off">
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox" id="vp-labor-active"> Aplicar Mano de Obra:</label>
                            <input type="number" id="vp-labor-cost-input" placeholder="Monto S/" min="0" class="numeric-input small-input" autocomplete="off">
                        </div>
                        <div class="setting-item profit-setting-item">
                            <label><input type="checkbox" id="vp-profit-active"> Aplicar Ganancia:</label>
                            <select id="vp-profit-type" class="small-input">
                                <option value="percent">%</option>
                                <option value="fixed">S/</option>
                            </select>
                            <input type="number" id="vp-profit-value-input" placeholder="Valor" min="0" class="numeric-input small-input" autocomplete="off">
                        </div>

                        <p class="area-display total-final">Precio Venta Pieza: <span id="preview-precio-venta">S/ 0.00</span></p>
                    </div>
                </div>

                <div class="button-group">
                    <button id="add-item-btn" class="large-button primary-button">Agregar a la cotizaci√≥n</button>
                    <button id="cancel-edit-btn" class="large-button secondary-button" style="display: none;">Cancelar Edici√≥n</button>
                </div>


            </section>

            <section id="summary-column">

                <div class="card">
                    <h2>Trabajos Agregados</h2>
                    <div class="table-container">
                        <table id="jobs-table">
                            <thead>
                                <tr>
                                    <th>C√≥d</th>
                                    <th>Descripci√≥n</th>
                                    <th>√Årea (m¬≤)</th>
                                    <th>Costo Interno (S/)</th>
                                    <th>Cantidad</th>
                                    <th>Precio Unit. (S/)</th>
                                    <th>Subtotal (S/)</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Las filas se insertar√°n aqu√≠ din√°micamente -->
                            </tbody>
                        </table>
                    </div>
                    <div id="jobs-cards-container" class="jobs-cards-container">
                        <!-- Las tarjetas se insertar√°n aqu√≠ din√°micamente en m√≥vil -->
                    </div>
                    <div class="total-final-section">
                        <div class="total-final">
                            TOTAL FINAL: <span id="summary-total">S/0.00</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>6. Generar Salida</h2>
                    <textarea id="final-notes" placeholder="Notas opcionales (ej. No bajar vidrios en 48hs)" class="large-textarea" autocomplete="off"></textarea>
                    <div class="output-buttons-group">
                        <button id="generate-pdf-btn" class="output-button" title="Generar PDF (WhatsApp)">üìÑ PDF</button>
                        <button id="print-thermal-btn" class="output-button" title="Imprimir Ticket (80mm)">üñ®Ô∏è Ticket</button>
                        <button id="print-generic-btn" class="output-button" title="Imprimir Gen√©rico">üñ®Ô∏è Gen√©rico</button>
                    </div>
                </div>

            </section>
        </main>
    </div>

    <!-- Toast Notification -->
    <div id="toast-notification" class="toast-notification"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/dataService.js"></script>
    <script src="js/uiController.js"></script>
    <script src="js/outputGenerator.js"></script>
    <script src="js/app.js"></script>
</body>
</html>